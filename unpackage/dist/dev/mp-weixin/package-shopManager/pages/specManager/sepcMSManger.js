(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["package-shopManager/pages/specManager/sepcMSManger"],{351:function(t,e,n){"use strict";(function(t){n(5),n(6);a(n(4));var e=a(n(352));function a(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n(1)["createPage"])},352:function(t,e,n){"use strict";n.r(e);var a=n(353),i=n(355);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n(357);var o,c=n(25),s=Object(c["default"])(i["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],o);s.options.__file="package-shopManager/pages/specManager/sepcMSManger.vue",e["default"]=s.exports},353:function(t,e,n){"use strict";n.r(e);var a=n(354);n.d(e,"render",(function(){return a["render"]})),n.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(e,"components",(function(){return a["components"]}))},354:function(t,e,n){"use strict";var a;n.r(e),n.d(e,"render",(function(){return i})),n.d(e,"staticRenderFns",(function(){return o})),n.d(e,"recyclableRender",(function(){return r})),n.d(e,"components",(function(){return a}));try{a={uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,642))},uniPopupDialog:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog")]).then(n.bind(null,649))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var t=this,e=t.$createElement;t._self._c},r=!1,o=[];i._withStripped=!0},355:function(t,e,n){"use strict";n.r(e);var a=n(356),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},356:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(){n.e("components/wybar/wyBar").then(function(){return resolve(n(542))}.bind(null,n)).catch(n.oe)},i={components:{wybar:a},computed:{i18n:function(){return this.$t("index")}},data:function(){return{spec:"",price:"",scrollHeight:0,data:[],isChinese:!0,isAdd:!0,productID:"",newSpecArr:[],mainName:"",mainCanshu:"",zhucanshu:[],noPut:!0,curContent:"",changeIndex:0,changeChildrenIndex:0}},onLoad:function(e){var n=t.getSystemInfoSync();if(this.navHeight=64+n.statusBarHeight,this.scrollHeight=n.windowHeight-this.navHeight,e.productID>0)this.isAdd=!1,this.productID=e.productID,this.getSpecDetail();else{this.isAdd=!0;var a=JSON.parse(e.guige);console.log(this.guigeArr),a.length>0?this.data=a:this.data=[{is_main:1,price:"",th_attr_name:"",attr_name:"",children:[{is_main:1,attr_name:"",price:"",th_attr_name:""}]},{is_main:0,price:"",th_attr_name:"",attr_name:"",children:[{is_main:0,attr_name:"",price:"",th_attr_name:""}]}]}},methods:{doAddCanshu:function(t){this.data[t].children.push({is_main:0,price:"",attr_name:"",th_attr_name:""})},inputDialogToggle:function(t,e,n){this.changeIndex=e,this.changeChildrenIndex=n,this.curContent=t,console.log(this.changeIndex,this.changeChildrenIndex,t),this.$refs.inputDialog.open()},dialogInputConfirm:function(t){console.log(t),this.data[this.changeIndex].children[this.changeChildrenIndex].attr_name=t,this.data[this.changeIndex].children[this.changeChildrenIndex].th_attr_name=t,console.log(this.data)},back:function(){t.navigateBack()},getSpecDetail:function(){var t=this,e={product_id:t.productID};this.http.sendRequest("MerchantStoreProductAttr.Read",e).then((function(e){if(0==e.code){console.log(e.info[0]);var n=e.info[0];0==n.length?(console.log(121),t.data=[{is_main:1,price:"",th_attr_name:"",attr_name:"",children:[{is_main:1,attr_name:"",price:"",th_attr_name:""}]},{is_main:0,price:"",th_attr_name:"",attr_name:"",children:[{is_main:0,attr_name:"",price:"",th_attr_name:""}]}]):1==n.length?(console.log(121),t.data=t.data.concat(n),t.data.push({is_main:0,price:"",th_attr_name:"",attr_name:"",children:[{is_main:0,attr_name:"",price:"",th_attr_name:""}]})):t.data=t.data.concat(n),console.log(t.data)}}))},save:function(){console.log(this.data);var e=this,n=[];n=n.concat(e.data);for(var a={},i=[],r=[],o=0;o<n.length;o++){var c=n[o];if(c.children.length>0){var s=c.children[c.children.length-1];""==s.attr_name&&c.children.pop(s)}""!=c.attr_name&&0!=c.children.length||t.showToast({title:"请正确输入规格名称、参数",icon:"none"}),c.id>0?r.push(c):i.push(c)}e.productID>0?r.length>0?(a={product_id:this.productID,attr:JSON.stringify(r)},this.http.sendRequest("MerchantStoreProductAttr.Update",a).then((function(a){0==a.code&&(t.$emit("addSpecDone",n),console.log(222),e.uploadNewData(i))}))):e.uploadNewData(i):(t.$emit("addSpecDone",n),e.back())},uploadNewData:function(e){var n=this;if(e.length>0){var a={product_id:this.productID,attr:JSON.stringify(e)};this.http.sendRequest("MerchantStoreProductAttr.Save",a).then((function(e){0==e.code&&(t.$emit("addSpecDone",n.data),n.back())}))}else console.log(111),t.$emit("addSpecDone",n.data),this.back()},inputPrice:function(t){var e=this.data[t.target.id];t.detail.value.length>0?e.price=t.detail.value:e.price="0"},inputSpec:function(t){var e=this.data[t.target.id];e.attr_name=t.detail.value,e.th_attr_name=t.detail.value},addSpec:function(){this.data.push({is_main:0,price:"",th_attr_name:"",attr_name:"",children:[{is_main:0,attr_name:"",price:"",th_attr_name:""}]})},deleteSpec:function(e){var n=this;t.showModal({title:"",content:n.i18n.shop.deletetip,success:function(t){t.confirm?n.delete(e):t.cancel}})},delete:function(t){console.log(t,this.productID);var e=this;if(this.productID>0){var n=e.data[t];console.log(n);var a={product_attr_id:n.id};e=this;this.http.sendRequest("MerchantStoreProductAttr.Delete",a).then((function(n){0==n.code&&(e.data.splice(t,1),0==e.data.length&&(e.data=[{price:"",th_attr_name:"",attr_name:"",children:[]}]))}))}else this.data.splice(t,1),0==this.data.length&&(this.data=[{price:"",th_attr_name:"",attr_name:"",children:[]}])},changeChinese:function(){this.isChinese=!0},changeTh:function(){this.isChinese=!1}}};e.default=i}).call(this,n(1)["default"])},357:function(t,e,n){"use strict";n.r(e);var a=n(358),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},358:function(t,e,n){}},[[351,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/package-shopManager/pages/specManager/sepcMSManger.js.map