{"version":3,"sources":["webpack:////Users/wangminxin/Desktop/外卖/用户/wanyue-take-user/take-user/components/tui-chat/message-input/index.vue?2968","webpack:////Users/wangminxin/Desktop/外卖/用户/wanyue-take-user/take-user/components/tui-chat/message-input/index.vue?cd15","webpack:////Users/wangminxin/Desktop/外卖/用户/wanyue-take-user/take-user/components/tui-chat/message-input/index.vue?8903","webpack:////Users/wangminxin/Desktop/外卖/用户/wanyue-take-user/take-user/components/tui-chat/message-input/index.vue?08e0","uni-app:///components/tui-chat/message-input/index.vue","webpack:////Users/wangminxin/Desktop/外卖/用户/wanyue-take-user/take-user/components/tui-chat/message-input/index.vue?55a4"],"names":["renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","firstSendMessage","inputText","extensionArea","sendMessageBtn","displayFlag","isAudio","bottomVal","startPoint","popupToggle","isRecording","canSend","text","title","notShow","isShow","recordTime","recordTimer","commonFunction","name","key","displayServiceEvaluation","displayCommonWords","displayOrderList","TUIEmoji","TUICommonWords","TUIOrderList","TUIServiceEvaluation","props","conversation","type","default","watch","handler","immediate","deep","beforeMount","clearInterval","duration","tempFilePath","fileSize","uni","icon","to","conversationType","payload","file","methods","switchAudio","handleLongPress","sampleRate","numberOfChannels","encodeBitRate","format","handleTouchMove","handleTouchEnd","handleEmoji","targetFlag","handleExtensions","error","console","handleSendPicture","handleSendImage","sendImageMessage","sourceType","count","success","onProgress","message","handleShootVideo","handleSendVideo","sendVideoMessage","maxDuration","camera","handleCommonFunctions","handleSendOrder","appendMessage","getToAccount","handleCalling","userID","sendTextMessage","onInputValueChange","$handleSendTextMessage","$handleSendCustomMessage","$handleCloseCards","$sendTIMMessage","detail","ext1","ext2","ext3","handleClose","handleServiceEvaluation","inputBindFocus","inputBindBlur"],"mappings":"wIAAA,oIACIA,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,8CACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCCRvB,yHAAg4B,eAAG,G,gtBC2Fn4B,CACAC,gBACA,OAGAC,oBACAC,aACAC,iBACAC,kBACAC,eACAC,WACAC,YACAC,aACAC,eACAC,eACAC,WACAC,YACAC,UACAC,WACAC,UACAC,aACAC,iBACAC,iBACAC,WACAC,SAEA,CACAD,YACAC,SAEA,CACAD,YACAC,UAGAC,4BACAC,sBACAC,sBAIAlC,YACAmC,WACAC,iBACAC,eACAC,wBAEAC,OACAC,cACAC,YACAC,uBAGAC,OACAH,cACAI,sBAMAC,aACAC,UAIAC,uBAAA,WAEA,4CACA,yCACAC,6BAGA,OACAC,gDACAC,4BACAC,uDAIA,GAFAC,gBAEA,UACA,kBACAA,aACA5B,eACA6B,kBAEA,CAEA,oCACAC,oBACAC,qCACAC,SACAC,UAGA,qBAIA,WACAtC,aACAC,eACAC,eACAC,WACAE,UACAD,kBAKAmC,SACAC,uBACA,cACA1C,sBACAM,eAIAqC,4BAAA,WACA,4BACAX,aAEAY,iBAEAC,mBAEAC,oBAEAC,eAEA,cACA7C,wBACAK,aAGAC,WACAC,UACAL,eACAD,eACAO,eAEA,yCACA,iBACA,MAIAsC,4BACA,mBACA,kEACA,cACA1C,YACAC,kBACAF,aAEA,iEACA,cACAC,YACAC,cACAF,aAGA,cACAC,YACAC,aACAF,eAOA4C,0BACA,cACA7C,eACAD,iBAEAgC,gBACA,6BAEAe,uBACA,cAEA,6BACAC,MAGA,cACApD,iBAIAqD,4BACA,kBAEA,iCACAD,MAGA,cACApD,iBAIAsD,kBACAC,uBAGAC,6BACA,iCAGAC,2BACA,gCAGAC,6BAAA,WACAtB,eACAuB,eACAC,QACAC,oBACA,MACA,oCACAvB,oBACAC,qCACAC,SACAC,QAEAqB,uBACAC,eAGA,0BAMAC,4BACA,iCAGAC,2BACA,gCAGAC,6BAAA,WACA9B,eACAuB,eAEAQ,eAEAC,cAEAP,oBACA,MACA,oCACAvB,oBACAC,qCACAC,SACAC,QAEAqB,uBACAC,eAGA,0BAMAM,kCACA,sCACA,QACA,cACApD,wBAEA,MAEA,QACA,cACAC,sBAEA,MAEA,QACA,cACAF,8BAEA,MAEA,QACA,QAIAsD,2BACA,cACApD,uBAIAqD,0BACA,cACA1E,0CACAE,qBAIAyE,wBACA,yDACA,SAGA,+BACA,UACA,0DAEA,YACA,4DAEA,QACA,0CAGAC,0BAEA,qCASA,8BADAC,OAyBAtC,aACA5B,kBACA6B,mBAlCAD,aACA5B,eACA6B,eAqCAsC,8BACA,0BACA,qBACA,+BACArC,KACAC,wCACAC,SACAjC,UAGA,cACAV,aACAE,oBAEA,2BAGA6E,+BACA,eACA,cACA7E,oBAGA,cACAA,qBAKA8E,mCACA,0CACA,cACA5D,yBAIA6D,qCACA,qCACAxC,uBACAC,wCACAC,2BAEA,wBACA,cACAtB,uBAIA6D,8BACA,qBACA,QACA,cACA9D,wBAEA,MAEA,QACA,cACAC,sBAEA,MAEA,QACA,cACAF,8BAEA,MAEA,QACA,QAIAgE,8BAAA,WACA,+BACA,0BACAC,QACAlB,aAIA3B,2CACAmB,eACA,oBACAnB,sBACAtB,mBACAoE,2BACAC,yBACAC,oBAGA,yBAEA,mBACA7B,eACAnB,sBACAtB,mBACAoE,4CACAC,yBACAC,uBAGA,cACApF,kBAIAqF,uBACA,cACArF,kBAIAsF,mCACA,cACAtE,+BAIAuE,0BACAhC,yCAGAiC,yBACAjC,0CAGA,c,6DC1kBA,yHAA+vC,eAAG,G","file":"components/tui-chat/message-input/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=1da00aa0&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/tui-chat/message-input/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=1da00aa0&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class=\"TUI-message-input-container\">\r\n\t\t\t<view class=\"TUI-commom-function\">\r\n\t\t\t\t<view v-for=\"(item, index) in 0\" :key=\"index\" class=\"TUI-commom-function-item\" :data-function=\"item\"\r\n\t\t\t\t\t@tap=\"handleCommonFunctions\">\r\n\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"TUI-message-input\">\r\n\t\t\t\t<!-- <image class=\"TUI-icon\" @tap=\"switchAudio\" :src=\"isAudio ? '/static/static/assets/keyboard.svg' : '/static/static/assets/audio.svg'\"></image> -->\r\n\t\t\t\t<view v-if=\"!isAudio\" class=\"TUI-message-input-main\">\r\n\t\t\t\t\t<input class=\"TUI-message-input-area\" :adjust-position=\"true\" cursor-spacing=\"20\"\r\n\t\t\t\t\t\tv-model=\"inputText\" @input=\"onInputValueChange\" maxlength=\"140\" type=\"text\"\r\n\t\t\t\t\t\tplaceholder-class=\"input-placeholder\" placeholder=\"说点什么呢~\" @focus=\"inputBindFocus\"\r\n\t\t\t\t\t\t@blur=\"inputBindBlur\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-else class=\"TUI-message-input-main\" @longpress=\"handleLongPress\" @touchmove=\"handleTouchMove\"\r\n\t\t\t\t\t@touchend=\"handleTouchEnd\"\r\n\t\t\t\t\tstyle=\"display: flex; justify-content: center; font-size: 32rpx; font-family: PingFangSC-Regular;\">\r\n\t\t\t\t\t<text>{{ text }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-message-input-functions\" hover-class=\"none\">\r\n\t\t\t\t\t<!-- <image class=\"TUI-icon\" @tap=\"handleEmoji\" src=\"/static/static/assets/face-emoji.svg\"></image> -->\r\n\t\t\t\t\t<!-- <view v-if=\"!sendMessageBtn\" @tap=\"handleExtensions\"><image class=\"TUI-icon\" src=\"/static/static/assets/more.svg\"></image></view> -->\r\n\t\t\t\t\t<!-- <view v-else class=\"TUI-sendMessage-btn\" @tap=\"sendTextMessage\">发送</view> -->\r\n\t\t\t\t\t<image class=\"TUI-icon\" @tap=\"sendTextMessage\" src=\"../../../static/message/send.png\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"displayFlag === 'emoji'\" class=\"TUI-Emoji-area\">\r\n\t\t\t\t<TUI-Emoji @enterEmoji=\"appendMessage\"></TUI-Emoji>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"displayFlag === 'extension'\" class=\"TUI-Extensions\">\r\n\t\t\t\t<!-- TODO: 这里功能还没实现 -->\r\n\t\t\t\t<!--        <camera device-position=\"back\" flash=\"off\" binderror=\"error\" style=\"width: 100%; height: 300px;\"></camera>-->\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleSendPicture\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/take-photo.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">拍摄照片</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleSendImage\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-img.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">发送图片</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleShootVideo\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/take-video.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">拍摄视频</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleSendVideo\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-video.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">发送视频</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- <view class=\"TUI-Extension-slot\" @tap=\"handleCalling(1)\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/audio-calling.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">语音通话</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleCalling(2)\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/video-calling.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">视频通话</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleServiceEvaluation\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/service-assess.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">服务评价</view>\r\n\t\t\t\t</view> -->\r\n\t\t\t\t<view class=\"TUI-Extension-slot\" @tap=\"handleSendOrder\">\r\n\t\t\t\t\t<image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-order.svg\"></image>\r\n\t\t\t\t\t<view class=\"TUI-Extension-slot-name\">发送订单</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<TUI-Common-Words class=\"tui-cards\" :display=\"displayCommonWords\" @sendMessage=\"$handleSendTextMessage\"\r\n\t\t\t\t@close=\"$handleCloseCards\"></TUI-Common-Words>\r\n\t\t\t<TUI-Order-List class=\"tui-cards\" :display=\"displayOrderList\" @sendCustomMessage=\"$handleSendCustomMessage\"\r\n\t\t\t\t@close=\"$handleCloseCards\"></TUI-Order-List>\r\n\t\t\t<TUI-Service-Evaluation class=\"tui-cards\" :display=\"displayServiceEvaluation\"\r\n\t\t\t\t@sendCustomMessage=\"$handleSendCustomMessage\" @close=\"$handleCloseCards\"></TUI-Service-Evaluation>\r\n\t\t</view>\r\n\t\t<view class=\"record-modal\" v-if=\"popupToggle\" @longpress=\"handleLongPress\" @touchmove=\"handleTouchMove\"\r\n\t\t\t@touchend=\"handleTouchEnd\">\r\n\t\t\t<view class=\"wrapper\">\r\n\t\t\t\t<view class=\"modal-loading\"></view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"modal-title\">{{ title }}</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport TUIEmoji from '../message-elements/emoji/index';\r\n\timport TUICommonWords from '../message-private/common-words/index';\r\n\timport TUIOrderList from '../message-private/order-list/index';\r\n\timport TUIServiceEvaluation from '../message-private/service-evaluation/index';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// todo  conversation\r\n\t\t\t\t// conversation: {},\r\n\t\t\t\tfirstSendMessage: true,\r\n\t\t\t\tinputText: '',\r\n\t\t\t\textensionArea: false,\r\n\t\t\t\tsendMessageBtn: false,\r\n\t\t\t\tdisplayFlag: '',\r\n\t\t\t\tisAudio: false,\r\n\t\t\t\tbottomVal: 0,\r\n\t\t\t\tstartPoint: 0,\r\n\t\t\t\tpopupToggle: false,\r\n\t\t\t\tisRecording: false,\r\n\t\t\t\tcanSend: true,\r\n\t\t\t\ttext: '按住说话',\r\n\t\t\t\ttitle: ' ',\r\n\t\t\t\tnotShow: false,\r\n\t\t\t\tisShow: true,\r\n\t\t\t\trecordTime: 0,\r\n\t\t\t\trecordTimer: null,\r\n\t\t\t\tcommonFunction: [{\r\n\t\t\t\t\t\tname: '常用语',\r\n\t\t\t\t\t\tkey: '0'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '发送订单',\r\n\t\t\t\t\t\tkey: '1'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '服务评价',\r\n\t\t\t\t\t\tkey: '2'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tdisplayServiceEvaluation: false,\r\n\t\t\t\tdisplayCommonWords: false,\r\n\t\t\t\tdisplayOrderList: false\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tcomponents: {\r\n\t\t\tTUIEmoji,\r\n\t\t\tTUICommonWords,\r\n\t\t\tTUIOrderList,\r\n\t\t\tTUIServiceEvaluation\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\tconversation: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: () => {}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tconversation: {\r\n\t\t\t\thandler: function(newVal) {\r\n\t\t\t\t\t// todo 值会被改变\r\n\t\t\t\t\t// this.setData({\r\n\t\t\t\t\t//   conversation: newVal\r\n\t\t\t\t\t// });\r\n\t\t\t\t},\r\n\t\t\t\timmediate: true,\r\n\t\t\t\tdeep: true\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbeforeMount() {\r\n\t\t\t// 加载声音录制管理器\r\n\t\t\tthis.recorderManager = uni.getRecorderManager();\r\n\t\t\tthis.recorderManager.onStop(res => {\r\n\t\t\t\tclearInterval(this.recordTimer);\r\n\t\t\t\t// 兼容 uniapp 打包app，duration 和 fileSize 需要用户自己补充\r\n\t\t\t\t// 文件大小 ＝ (音频码率) x 时间长度(单位:秒) / 8\r\n\t\t\t\tlet msg = {\r\n\t\t\t\t\tduration: res.duration ? res.duration : this.recordTime * 1000,\r\n\t\t\t\t\ttempFilePath: res.tempFilePath,\r\n\t\t\t\t\tfileSize: res.fileSize ? res.fileSize : ((48 * this.recordTime) / 8) * 1024\r\n\t\t\t\t};\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\t// 兼容 uniapp 语音消息没有duration\r\n\t\t\t\tif (this.canSend) {\r\n\t\t\t\t\tif (msg.duration < 1000) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '录音时间太短',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// res.tempFilePath 存储录音文件的临时路径\r\n\t\t\t\t\t\tconst message = uni.$TUIKit.createAudioMessage({\r\n\t\t\t\t\t\t\tto: this.getToAccount(),\r\n\t\t\t\t\t\t\tconversationType: this.conversation.type,\r\n\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\tfile: msg\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.$sendTIMMessage(message);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tstartPoint: 0,\r\n\t\t\t\t\tpopupToggle: false,\r\n\t\t\t\t\tisRecording: false,\r\n\t\t\t\t\tcanSend: true,\r\n\t\t\t\t\ttitle: ' ',\r\n\t\t\t\t\ttext: '按住说话'\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\tswitchAudio() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tisAudio: !this.isAudio,\r\n\t\t\t\t\ttext: '按住说话'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleLongPress(e) {\r\n\t\t\t\tthis.recorderManager.start({\r\n\t\t\t\t\tduration: 60000,\r\n\t\t\t\t\t// 录音的时长，单位 ms，最大值 600000（10 分钟）\r\n\t\t\t\t\tsampleRate: 44100,\r\n\t\t\t\t\t// 采样率\r\n\t\t\t\t\tnumberOfChannels: 1,\r\n\t\t\t\t\t// 录音通道数\r\n\t\t\t\t\tencodeBitRate: 192000,\r\n\t\t\t\t\t// 编码码率\r\n\t\t\t\t\tformat: 'aac' // 音频格式，选择此格式创建的音频消息，可以在即时通信 IM 全平台（Android、iOS、微信小程序和Web）互通\r\n\t\t\t\t});\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tstartPoint: e.touches[0],\r\n\t\t\t\t\ttitle: '正在录音',\r\n\t\t\t\t\t// isRecording : true,\r\n\t\t\t\t\t// canSend: true,\r\n\t\t\t\t\tnotShow: true,\r\n\t\t\t\t\tisShow: false,\r\n\t\t\t\t\tisRecording: true,\r\n\t\t\t\t\tpopupToggle: true,\r\n\t\t\t\t\trecordTime: 0\r\n\t\t\t\t});\r\n\t\t\t\tthis.recordTimer = setInterval(() => {\r\n\t\t\t\t\tthis.recordTime++;\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\r\n\t\t\t// 录音时的手势上划移动距离对应文案变化\r\n\t\t\thandleTouchMove(e) {\r\n\t\t\t\tif (this.isRecording) {\r\n\t\t\t\t\tif (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 100) {\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\ttext: '抬起停止',\r\n\t\t\t\t\t\t\ttitle: '松开手指，取消发送',\r\n\t\t\t\t\t\t\tcanSend: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 20) {\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\ttext: '抬起停止',\r\n\t\t\t\t\t\t\ttitle: '上划可取消',\r\n\t\t\t\t\t\t\tcanSend: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\ttext: '抬起停止',\r\n\t\t\t\t\t\t\ttitle: '正在录音',\r\n\t\t\t\t\t\t\tcanSend: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 手指离开页面滑动\r\n\t\t\thandleTouchEnd() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tisRecording: false,\r\n\t\t\t\t\tpopupToggle: false\r\n\t\t\t\t});\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tthis.recorderManager.stop();\r\n\t\t\t},\r\n\t\t\thandleEmoji() {\r\n\t\t\t\tlet targetFlag = 'emoji';\r\n\r\n\t\t\t\tif (this.displayFlag === 'emoji') {\r\n\t\t\t\t\ttargetFlag = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayFlag: targetFlag\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleExtensions() {\r\n\t\t\t\tlet targetFlag = 'extension';\r\n\r\n\t\t\t\tif (this.displayFlag === 'extension') {\r\n\t\t\t\t\ttargetFlag = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayFlag: targetFlag\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\terror(e) {\r\n\t\t\t\tconsole.log(e.detail);\r\n\t\t\t},\r\n\r\n\t\t\thandleSendPicture() {\r\n\t\t\t\tthis.sendImageMessage('camera');\r\n\t\t\t},\r\n\r\n\t\t\thandleSendImage() {\r\n\t\t\t\tthis.sendImageMessage('album');\r\n\t\t\t},\r\n\r\n\t\t\tsendImageMessage(type) {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tsourceType: [type],\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\t\tconst message = uni.$TUIKit.createImageMessage({\r\n\t\t\t\t\t\t\t\tto: this.getToAccount(),\r\n\t\t\t\t\t\t\t\tconversationType: this.conversation.type,\r\n\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\tfile: res\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tonProgress: percent => {\r\n\t\t\t\t\t\t\t\t\tmessage.percent = percent;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.$sendTIMMessage(message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleShootVideo() {\r\n\t\t\t\tthis.sendVideoMessage('camera');\r\n\t\t\t},\r\n\r\n\t\t\thandleSendVideo() {\r\n\t\t\t\tthis.sendVideoMessage('album');\r\n\t\t\t},\r\n\r\n\t\t\tsendVideoMessage(type) {\r\n\t\t\t\tuni.chooseVideo({\r\n\t\t\t\t\tsourceType: [type],\r\n\t\t\t\t\t// 来源相册或者拍摄\r\n\t\t\t\t\tmaxDuration: 60,\r\n\t\t\t\t\t// 设置最长时间60s\r\n\t\t\t\t\tcamera: 'back',\r\n\t\t\t\t\t// 后置摄像头\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\t\tconst message = uni.$TUIKit.createVideoMessage({\r\n\t\t\t\t\t\t\t\tto: this.getToAccount(),\r\n\t\t\t\t\t\t\t\tconversationType: this.conversation.type,\r\n\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\tfile: res\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tonProgress: percent => {\r\n\t\t\t\t\t\t\t\t\tmessage.percent = percent;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.$sendTIMMessage(message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleCommonFunctions(e) {\r\n\t\t\t\tswitch (e.target.dataset.function.key) {\r\n\t\t\t\t\tcase '0':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayCommonWords: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase '1':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayOrderList: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase '2':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayServiceEvaluation: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\thandleSendOrder() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayOrderList: true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tappendMessage(e) {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tinputText: this.inputText + e.detail.message,\r\n\t\t\t\t\tsendMessageBtn: true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tgetToAccount() {\r\n\t\t\t\tif (!this.conversation || !this.conversation.conversationID) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (this.conversation.type) {\r\n\t\t\t\t\tcase 'C2C':\r\n\t\t\t\t\t\treturn this.conversation.conversationID.replace('C2C', '');\r\n\r\n\t\t\t\t\tcase 'GROUP':\r\n\t\t\t\t\t\treturn this.conversation.conversationID.replace('GROUP', '');\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn this.conversation.conversationID;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleCalling(value) {\r\n\t\t\t\t// todo 目前支持单聊\r\n\t\t\t\tif (this.conversation.type === 'GROUP') {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '群聊暂不支持',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst {\r\n\t\t\t\t\tuserID\r\n\t\t\t\t} = this.conversation.userProfile;\r\n\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tif (typeof(uni.$TUICalling) === 'undefined') {\r\n\t\t\t\t\tlogger.error(\r\n\t\t\t\t\t\t'请使用真机运行并且自定义基座调试，可能影响音视频功能～ 插件地址：https://ext.dcloud.net.cn/plugin?id=7097 , 调试地址：https://nativesupport.dcloud.net.cn/NativePlugin/use/use'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请使用真机运行并且自定义基座调试，可能影响音视频功能～ ',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.$TUICalling.call({\r\n\t\t\t\t\t\t\tuserID: userID,\r\n\t\t\t\t\t\t\ttype: value\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tres => {\r\n\t\t\t\t\t\t\tconsole.log(JSON.stringify(res));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '微信小程序暂不支持',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\t// uni.$wxTUICalling.call({userID, type: value})\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tsendTextMessage(msg, flag) {\r\n\t\t\t\tconst to = this.getToAccount();\r\n\t\t\t\tconst text = flag ? msg : this.inputText;\r\n\t\t\t\tconst message = uni.$TUIKit.createTextMessage({\r\n\t\t\t\t\tto,\r\n\t\t\t\t\tconversationType: this.conversation.type,\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\ttext\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tinputText: '',\r\n\t\t\t\t\tsendMessageBtn: false\r\n\t\t\t\t});\r\n\t\t\t\tthis.$sendTIMMessage(message,text);\r\n\t\t\t},\r\n\r\n\t\t\tonInputValueChange(event) {\r\n\t\t\t\tif (event.detail.value) {\r\n\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\tsendMessageBtn: true\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\tsendMessageBtn: false\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t$handleSendTextMessage(event) {\r\n\t\t\t\tthis.sendTextMessage(event.detail.message, true);\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayCommonWords: false\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t$handleSendCustomMessage(e) {\r\n\t\t\t\tconst message = uni.$TUIKit.createCustomMessage({\r\n\t\t\t\t\tto: this.getToAccount(),\r\n\t\t\t\t\tconversationType: this.conversation.type,\r\n\t\t\t\t\tpayload: e.detail.payload\r\n\t\t\t\t});\r\n\t\t\t\tthis.$sendTIMMessage(message);\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayOrderList: false\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t$handleCloseCards(e) {\r\n\t\t\t\tswitch (e.detail.key) {\r\n\t\t\t\t\tcase '0':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayCommonWords: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase '1':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayOrderList: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase '2':\r\n\t\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\t\tdisplayServiceEvaluation: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t$sendTIMMessage(message,text) {\r\n\t\t\t\tconst SDKAppID = getApp().globalData.SDKAppID;\r\n\t\t\t\tthis.$emit('sendMessage', {\r\n\t\t\t\t\tdetail: {\r\n\t\t\t\t\t\tmessage\r\n\t\t\t\t\t}\r\n\t\t\t\t});\n\t\t\t\t// console.log(getApp().globalData.appName,text)\r\n\t\t\t\tuni.$TUIKit.sendMessage(message).then((res) => {\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (this.firstSendMessage) {\r\n\t\t\t\t\t\tuni.$aegis.reportEvent({\r\n\t\t\t\t\t\t\tname: 'sendMessage',\r\n\t\t\t\t\t\t\text1: 'sendMessage-success',\r\n\t\t\t\t\t\t\text2: 'uniTuikitExternal',\r\n\t\t\t\t\t\t\text3: `${SDKAppID}`,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.firstSendMessage = false\n\t\t\t\t\t\r\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\tuni.$aegis.reportEvent({\r\n\t\t\t\t\t\tname: 'sendMessage',\r\n\t\t\t\t\t\text1: `sendMessage-failed#error: ${error}`,\r\n\t\t\t\t\t\text2: 'uniTuikitExternal',\r\n\t\t\t\t\t\text3: `${SDKAppID}`,\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayFlag: ''\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleClose() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayFlag: ''\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleServiceEvaluation() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tdisplayServiceEvaluation: true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tinputBindFocus() {\r\n\t\t\t\tconsole.log('占位：函数 inputBindFocus 未声明');\r\n\t\t\t},\r\n\r\n\t\t\tinputBindBlur() {\r\n\t\t\t\tconsole.log('占位：函数 inputBindBlur 未声明');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n<style>\r\n\t@import './index.css';\r\n</style>\n","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}