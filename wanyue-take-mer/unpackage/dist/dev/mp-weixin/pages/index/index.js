(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{36:function(n,t,e){"use strict";(function(n){e(5),e(6);o(e(4));var t=o(e(37));function o(n){return n&&n.__esModule?n:{default:n}}wx.__webpack_require_UNI_MP_PLUGIN__=e,n(t.default)}).call(this,e(1)["createPage"])},37:function(n,t,e){"use strict";e.r(t);var o=e(38),i=e(40);for(var a in i)"default"!==a&&function(n){e.d(t,n,(function(){return i[n]}))}(a);e(43);var r,s=e(25),c=Object(s["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],r);c.options.__file="pages/index/index.vue",t["default"]=c.exports},38:function(n,t,e){"use strict";e.r(t);var o=e(39);e.d(t,"render",(function(){return o["render"]})),e.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),e.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),e.d(t,"components",(function(){return o["components"]}))},39:function(n,t,e){"use strict";var o;e.r(t),e.d(t,"render",(function(){return i})),e.d(t,"staticRenderFns",(function(){return r})),e.d(t,"recyclableRender",(function(){return a})),e.d(t,"components",(function(){return o}));var i=function(){var n=this,t=n.$createElement;n._self._c},a=!1,r=[];i._withStripped=!0},40:function(n,t,e){"use strict";e.r(t);var o=e(41),i=e.n(o);for(var a in o)"default"!==a&&function(n){e.d(t,n,(function(){return o[n]}))}(a);t["default"]=i.a},41:function(n,t,e){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){e.e("components/orderlist/orderListView").then(function(){return resolve(e(535))}.bind(null,e)).catch(e.oe)},i=e(42),a=new i.AMapWX({key:getApp().globalData.amapKey}),r={components:{orderListV:o},data:function(){return{islogin:!1,scrollHeight:0,tabbar:[],tabIndex:0,orderNumberDic:{},curAdsMsg:{name:"",desc:""},sckChatServer:"",nottransportNum:"0",transportingNum:"0",doneNum:"0",refundNum:"0",waitNum:"0",topHeight:0,marginTopHeight:0}},computed:{i18n:function(){return this.$t("index")}},onReady:function(){var t=n.getSystemInfoSync();this.marginTopHeight=getApp().globalData.menuButtonHeight+getApp().globalData.statusBarHeight,this.topHeight=this.marginTopHeight+44+80,this.scrollHeight=t.windowHeight-this.topHeight,this.tabbar=[this.i18n.index.waitreceive,this.i18n.index.waitsong,this.i18n.index.songing,this.i18n.index.done,this.i18n.index.refund],console.log("onready")},onShow:function(){console.log("onshow");var t=n.getStorageSync("userinfo");console.log(t),t&&t.uid>0?(this.islogin=!0,this.requestCount(),this.getUnreadMsg()):this.islogin=!1},onLoad:function(){var t=this,e=n.getStorageSync("userinfo");e&&e.uid>0?(this.getHomeConfig(),this.islogin=!0):n.reLaunch({url:"../login/login"}),this.getLocationsss(),this.islogin&&this.requestCount();var o=this;n.$on("updateOrderCount",(function(n){o.requestCount()})),n.$on("refreshList",(function(n){t.tabbarClick(0),t.tabbarClick(1),t.tabbarClick(2),t.tabbarClick(3),t.tabbarClick(4),o.requestCount()}))},onUnload:function(){n.$off("updateOrderCount")},methods:{getclientID:function(){var t=this;n.getPushClientId({success:function(n){console.log("111111111",n.cid),t.uploadCid(n.cid)},fail:function(n){console.log("2222222",n)},complete:function(n){console.log("111111",n)}})},uploadCid:function(n){var t=this;t.http.sendRequest("Push.Update",{cid:n}).then((function(n){}))},requestCount:function(){var n=this;this.http.sendRequest("MerchantOrder.GetNumber").then((function(t){if(0==t.code){n.islogin=!0;var e=t.info[0];n.waitNum=e.type1,n.nottransportNum=e.type2,n.transportingNum=e.type3,n.doneNum=e.type4,n.refundNum=e.type5}else 700==t.code&&(n.islogin=!1)}))},getHomeConfig:function(){var t=this;this.http.sendAppRequest("Home.GetConfig").then((function(e){var o=n.getStorageSync("userinfo");if(console.log(o.token),o&&o.uid>0){var i=e.info[0].chatserver;t.sckChatServer=t.http.decypt(i),t.socektMethod(t.sckChatServer)}n.setStorage({key:"Config",data:e.info[0]})}))},socektMethod:function(t){console.log(t);var e=this;if(this.islogin){var o=n.connectSocket({url:t,success:function(){console.log("socket链接成gong")}});o.onOpen((function(t){console.log("WebSocket连接已打开！",t);var e=n.getStorageSync("userinfo"),i={action:"mer_join",uid:e.uid,token:e.token};o.send({data:JSON.stringify(i),success:function(n){console.log("fasongchengggggg ")},fail:function(n){console.log(n)}})})),o.onError((function(n){console.log("WebSocket连接打开失败，请检查！",n),o.close(),o=null})),o.onClose((function(n){console.log("WebSocket 已关闭！"),o=null})),o.onMessage((function(n){var t=JSON.parse(n.data);console.log("收到服务器内容：",t),"joinRoomBack"==t.action&&console.log("加入房间状态:"+t.success),"orders_new"==t.action&&(console.log("新订单（待接单）"),e.onPlayAudio(1),e.requestCount(),e.$refs.waitReceive.updateData(1),"android"==getApp().globalData.platform&&e.getOrderData(t.data.order_id))}))}},getOrderData:function(n){var t=this;this.http.sendRequest("MerchantOrder.GetOrderPrintData",{id:n}).then((function(n){if(0==n.code){var e=n.info[0];if(1==parseInt(e.store.auto_print)){console.log(e),e.app_name=t.i18n.index.appname;var o=printer.getPrintHexString(e);printModule.send(o)}}}))},onPlayAudio:function(t){var e=n.getStorageSync("shopinfo");if(0!=e.tohes){var o=null;o=n.getBackgroundAudioManager(),o.title=this.i18n.index.yuyinbobao,o.singer=this.i18n.index.title,o.src=getApp().globalData.weburl+"uniapp/music/mer-neworder.mp3",o.play(),o.onEnded((function(n){o=null}))}},onSendJoinSocket:function(){console.log("faxiaoxile");var t=n.getStorageSync("userinfo"),e={action:"mer_join",uid:t.uid,token:t.token};n.sendSocketMessage({data:JSON.stringify(e),success:function(n){console.log("fasongchengggggg ")},fail:function(n){console.log(n)}})},initListeners:function(){globalEvent.addEventListener("Init",(function(n){console.log(n)})),globalEvent.addEventListener("PrinterState",(function(n){console.log(n)})),globalEvent.addEventListener("SendRawData",(function(n){console.log(n)})),globalEvent.addEventListener("DeInit",(function(n){console.log(n)}))},widthOfString:function(){var n=" ";printer.widthOfString(n)},init:function(){},getPrinterState:function(){},deInit:function(){},send:function(){},getUnreadMsg:function(){this.http.sendRequest("Message.GetUnreadMessage").then((function(t){if(0==t.code){var e=t.info[0];parseInt(e.count)>0?n.setTabBarBadge({index:2,text:e.count}):n.removeTabBarBadge({index:2})}}))},cellItemClick:function(t,e){console.log(e),n.navigateTo({url:"../../package-index/pages/indexOrderDetail?id="+t.id})},doZiti:function(){this.islogin?n.navigateTo({url:"../../package-index/pages/ziti"}):n.navigateTo({url:"../login/login"})},doScan:function(){this.islogin?n.navigateTo({url:"../../package-index/pages/scan"}):n.navigateTo({url:"../login/login"})},login:function(){n.navigateTo({url:"../login/login"})},getLocationsss:function(){console.log("getLocationsss"),a.getRegeo({success:function(n){console.log(n)},fail:function(n){console.log(n)}})},tabbarClick:function(n){this.tabIndex=n,0==n?this.$refs.waitReceive.updateData(1):1==n?this.$refs.waitRider.updateData(2):2==n?this.$refs.ridering.updateData(3):3==n?this.$refs.orderDone.updateData(4):4==n&&this.$refs.orderRefund.updateData(5)},animationfinish:function(n){this.tabIndex=n.detail.current}}};t.default=r}).call(this,e(1)["default"])},43:function(n,t,e){"use strict";e.r(t);var o=e(44),i=e.n(o);for(var a in o)"default"!==a&&function(n){e.d(t,n,(function(){return o[n]}))}(a);t["default"]=i.a},44:function(n,t,e){}},[[36,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/index/index.js.map