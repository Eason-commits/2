(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["package-mine/pages/editProfile/editProfile"],{173:function(e,t,n){"use strict";(function(e){n(5),n(6);o(n(4));var t=o(n(174));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},174:function(e,t,n){"use strict";n.r(t);var o=n(175),a=n(177);for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n(179);var i,r=n(25),h=Object(r["default"])(a["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],i);h.options.__file="package-mine/pages/editProfile/editProfile.vue",t["default"]=h.exports},175:function(e,t,n){"use strict";n.r(t);var o=n(176);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},176:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return i})),n.d(t,"recyclableRender",(function(){return s})),n.d(t,"components",(function(){return o}));var a=function(){var e=this,t=e.$createElement;e._self._c},s=!1,i=[];a._withStripped=!0},177:function(e,t,n){"use strict";n.r(t);var o=n(178),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a},178:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={computed:{i18n:function(){return this.$t("index")}},data:function(){return{userInfo:"",menuButtonHeight:32,top:0,windowHeight:0,shopName:"",shopPhone:"",shopType:"",address:"",selectImage:"",shoplogo:"",shopTypeID:"",firstTypeID:"",thumbPath:"",addressDic:"",lat:"",lng:"",isChangeImage:0,name_th:""}},onShareTimeline:function(e){},onShareAppMessage:function(e){},onLoad:function(t){var n=this;if(this.top=getApp().globalData.top,this.menuButtonHeight=getApp().globalData.menuButtonHeight,this.windowHeight=getApp().globalData.screenHeight-44,e.setNavigationBarTitle({title:this.i18n.mine.profile}),t.info){var o=JSON.parse(t.info);console.log(o),this.configureData(o)}else this.getData();e.$on("namechange",(function(e,t){n.shopName=e,n.name_th=t})),e.$on("phonechange",(function(e){n.shopPhone=e}));var a=this;e.$on("userChangeShopType",(function(e){console.log(e),a.shopTypeID=e.secondID,a.shopType=e.firstName+"-"+e.secondName,a.firstTypeID=e.firstID})),e.$on("updateAddress",(function(e){console.log(e),a.address=e.address+e.detailAddress,a.lng=e.lng,a.lat=e.lat}))},onUnload:function(){e.$off("namechange"),e.$off("phonechange"),e.$off("userChangeShopType"),e.$off("updateAddress")},methods:{changeLogo:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths,o=n[0];t.thumbPath=o,t.isChangeImage=1}})},changeName:function(){e.navigateTo({url:"./editName?type=1&content="+this.shopName+"&name_th="+this.name_th})},changePhone:function(){e.navigateTo({url:"editName?type=2&content="+this.shopPhone})},changeShopType:function(){e.navigateTo({url:"shopType"})},changeShopAddress:function(){e.navigateTo({url:"../address/address?content="+this.address})},save:function(){e.showLoading({title:this.i18n.mine.shangchuanzhong,mask:!1}),this.isChangeImage?this.uploadImageToservice():this.doSave()},uploadImageToservice:function(){var t=this,n=e.getStorageSync("userinfo"),o={};n&&(o.uid=n.uid,o.token=n.token),e.uploadFile({url:getApp().globalData.weburl+"api/?s=Merchant.Upload.Upload",filePath:t.thumbPath,name:"file",formData:o,success:function(n){console.log(n),e.hideLoading();var o=JSON.parse(n.data);t.shoplogo=o.data.info[0].url_all,t.doSave()},fail:function(t){e.hideLoading()}})},doSave:function(){var t=this,n={};this.shopName.length>0&&(n.name=this.shopName),this.shopPhone.length>0&&(n.phone=this.shopPhone),this.address.length>0&&(n.address=this.address),this.shoplogo.length>0&&(n.thumb=this.shoplogo),this.lng.length>0&&(n.lng=this.lng),this.lat.length>0&&(n.lat=this.lat),this.name_th.length>0&&(n.th_name=this.name_th),n.type_id=this.shopTypeID,console.log(n),e.hideLoading(),t.http.sendRequest("Users.Update",n).then((function(n){if(0==n.code){t.addressDic={address:t.address,lng:t.lng,lat:t.lat},e.setStorage({key:"shopAddress",data:t.addressDic,success:function(){console.log("地址存储成功"+t.addressDic)}});var o=e.$TUIKit.updateMyProfile({avatar:t.shoplogo,nick:t.shopName});o.then((function(e){console.log(e.data),console.log("更新资料成功")})).catch((function(e){console.warn("updateMyProfile error:",e)})),e.navigateBack()}}))},configureData:function(e){this.userInfo=e,this.shopName=e.name,this.shoplogo=e.thumb,this.shopPhone=e.phone,this.shopType=e.type_name,this.address=e.address,this.thumbPath=e.thumb,this.lng=e.lng,this.lat=e.lat,this.shopTypeID=e.type_id,this.name_th=e.th_name},getData:function(){var e=this;e.http.sendRequest("Users.Home").then((function(t){if(700==t.code)e.islogin=!1;else{var n=t.info[0];e.configureData(n)}}))}}};t.default=n}).call(this,n(1)["default"])},179:function(e,t,n){"use strict";n.r(t);var o=n(180),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a},180:function(e,t,n){}},[[173,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/package-mine/pages/editProfile/editProfile.js.map