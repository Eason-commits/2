(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["package-publishOrder/pages/order-map-detaile"],{261:function(e,t,n){"use strict";(function(e){n(5),n(6);o(n(4));var t=o(n(262));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},262:function(e,t,n){"use strict";n.r(t);var o=n(263),i=n(265);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n(267),n(269);var a,s=n(25),d=Object(s["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);d.options.__file="package-publishOrder/pages/order-map-detaile.nvue",t["default"]=d.exports},263:function(e,t,n){"use strict";n.r(t);var o=n(264);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},264:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return r})),n.d(t,"components",(function(){return o}));var i=function(){var e=this,t=e.$createElement;e._self._c},r=!1,a=[];i._withStripped=!0},265:function(e,t,n){"use strict";n.r(t);var o=n(266),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},266:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(26));function i(e){return e&&e.__esModule?e:{default:e}}var r=n(42),a=new r.AMapWX({key:getApp().globalData.amapKey}),s=function(){Promise.all([n.e("common/vendor"),n.e("components/banxing/merbanStar")]).then(function(){return resolve(n(626))}.bind(null,n)).catch(n.oe)},d={components:{starV:s},computed:{i18n:function(){return getApp().globalData.$t("index")}},data:function(){return{windowHeight:0,windowWidth:0,statusBarHeight:0,menuButtonWidth:0,markers:[],latitude:0,longitude:0,polyline:[],orderType:0,orderID:"",orderMsg:null,initTop:0,viewTop:0,detaileHeight:0,lastY:0,lastTY:0,isShowPrice:0,opacity:0,position:{y:0},showFeeDetail:!1,priceDic:{},cateName:"",desc:"",showpay:0,firstMarkers:"",poisdatas:[]}},onLoad:function(t){var n=this,o=e.getSystemInfoSync();n.windowHeight=o.windowHeight,n.windowWidth=o.windowWidth,n.statusBarHeight=getApp().globalData.top+48,n.menuButtonWidth=getApp().globalData.menuButtonWidth,n.initTop=.675*o.windowHeight-80,n.viewTop=n.initTop,n.orderID=t.ID},onReady:function(){var e=this;a.getRegeo({iconPath:"../../static/logo.png",width:10,height:10,success:function(t){var n=t[0];e.latitude=n.latitude,e.longitude=n.longitude},fail:function(e){console.log("失败回调"+e)}}),a.getPoiAround({success:function(e){},fail:function(e){console.log(e)}}),o.default.sendAppRequest("Orders.GetDetail",{orderid:e.orderID}).then((function(t){if(0==t.code){e.orderMsg=t.info[0],e.orderType=e.orderMsg.type,e.orderType=e.orderMsg.type,e.priceDic=e.orderMsg.extra.computed,e.priceDic.money_time=e.orderMsg.extra.timemoney,e.cateName=e.orderMsg.extra.catename,console.log(e.orderMsg);var n="../static/order-map-shou@2x.png";e.markers=[{id:12312232,width:45,height:45,latitude:e.orderMsg.t_lat,longitude:e.orderMsg.t_lng,iconPath:n,coordType:"wgs84"}],e.requestOrderMessage()}}))},onShow:function(){console.log(2221)},methods:{doBack:function(){e.navigateBack({})},openPriceDetail:function(){this.showFeeDetail=!this.showFeeDetail},requestOrderMessage:function(){var e=this;o.default.sendAppRequest("Orders.GetLocation",{orderid:e.orderID}).then((function(t){0==t.code&&e.getRidingRoute(t.info[0])}))},getRidingRoute:function(e){var t=this;3==t.orderMsg.status?(console.log(parseFloat(e.lng).toFixed(6)+","+parseFloat(e.lat).toFixed(6)),a.getRidingRoute({origin:t.orderMsg.f_lng+","+t.orderMsg.f_lat,destination:parseFloat(e.lng).toFixed(6)+","+parseFloat(e.lat).toFixed(6),success:function(e){console.log(e);var n=e.paths[0].distance,o=t.i18n.postorder.distance;n>999&&parseFloat(n/1e3).toFixed(1);var i="../static/order-map-qu@2x.png",r=[{id:12312232,width:45,height:45,latitude:t.orderMsg.t_lat,longitude:t.orderMsg.t_lng,iconPath:i,coordType:"wgs84"}];t.markers=r,console.log(t.markers),t.$forceUpdate()},fail:function(e){console.log(e)}})):a.getRidingRoute({origin:t.orderMsg.t_lng+","+t.orderMsg.t_lat,destination:e.lng+","+e.lat,success:function(n){console.log(n);var o=n.paths[0].distance,i="",r=t.i18n.postorder.distanceshou;i=o>999?r+parseFloat(o/1e3).toFixed(1)+"km":r+o+"米";var a="../static/order-map-shou@2x.png",s=[{id:12312232,width:45,height:45,latitude:t.orderMsg.t_lat,longitude:t.orderMsg.t_lng,iconPath:a,coordType:"wgs84"},{id:12312234,width:45,height:45,latitude:e.lat,longitude:e.lng,iconPath:"../static/order-map-rider@2x.png",coordType:"wgs84",callout:{content:i,padding:"5",borderRadius:"12.5",textAlign:"center",display:"ALWAYS",color:"#323232",bgColor:"#FFFFFF",fontSize:"14"}}];t.markers=s,console.log(t.markers),t.$forceUpdate()},fail:function(e){console.log(e)}})},doOrderStateDetail:function(){e.navigateTo({url:"./ordertracking?orderID="+this.orderID})},tuikuanjindu:function(){e.navigateTo({url:"refundOrder/refundDetails?orderID="+this.orderID})},onChange:function(e){},refundOrder:function(){e.navigateTo({url:"refundOrder/applyRefund?orderID="+this.orderMsg.id+"&orderno="+this.orderMsg.orderno+"&money="+this.orderMsg.money})},call:function(){var t=this;e.makePhoneCall({phoneNumber:t.orderMsg.rinfo.mobile})},showBigImage:function(t){var n=this;e.previewImage({current:t,urls:n.orderMsg.thumbs})},priceMessage:function(){this.isShowPrice=!this.isShowPrice},copyWord:function(){var t=this;e.setClipboardData({data:t.orderMsg.orderno}),e.showToast({title:"复制成功",icon:"none"})},touchmove:function(t){var n=this,o=t.changedTouches[0].pageY,i=o-this.lastY;if(i<0){if(this.lastTY>0&&this.lastTY<5)return;"向上滑动"}else if(i>0&&("向下滑动",this.lastTY<0&&this.lastTY>-5))return;this.lastTY=i;var r=e.createSelectorQuery().in(this);r.select("#detaileView").boundingClientRect((function(e){var t=n.windowHeight-e.bottom;t<40?(n.viewTop=n.viewTop+i,n.viewTop>n.initTop&&(n.viewTop=n.initTop),n.onchangeOpacity()):i>0&&(n.viewTop=n.viewTop+i,n.onchangeOpacity()),n.lastY=o})).exec()},handletouchstart:function(e){this.lastY=e.changedTouches[0].pageY},moveAppPlus:function(){var e=this,t=this.getEl(this.$refs.detaileView);obj=Binding.bind({anchor:t,eventType:"pan",props:[{element:t,property:"transform.translateY",expression:"y+".concat(this.position.y)}]},(function(t){"end"===t.state&&(console.log(t.deltaY),e.position.y+=t.deltaY,console.log(e.position.y),e.onchangeOpacity())}))},getEl:function(e){return"string"===typeof e||"number"===typeof e?e:WXEnvironment?e.ref:e instanceof HTMLElement?e:e.$el},onchangeOpacity:function(){var t=this,n=e.createSelectorQuery().in(this);n.select("#detaileView").boundingClientRect((function(e){console.log(e.top,e.bottom),e.top<=t.statusBarHeight?t.opacity=(t.statusBarHeight-e.top)/t.statusBarHeight>1?1:(t.statusBarHeight-e.top)/t.statusBarHeight:t.opacity=0})).exec()}}};t.default=d}).call(this,n(1)["default"])},267:function(e,t,n){"use strict";n.r(t);var o=n(268),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},268:function(e,t,n){},269:function(e,t,n){"use strict";n.r(t);var o=n(270),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},270:function(e,t,n){}},[[261,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/package-publishOrder/pages/order-map-detaile.js.map