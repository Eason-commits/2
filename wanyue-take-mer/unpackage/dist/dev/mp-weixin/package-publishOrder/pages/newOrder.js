(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["package-publishOrder/pages/newOrder"],{237:function(e,t,i){"use strict";(function(e){i(5),i(6);n(i(4));var t=n(i(238));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=i,e(t.default)}).call(this,i(1)["createPage"])},238:function(e,t,i){"use strict";i.r(t);var n=i(239),o=i(241);for(var s in o)"default"!==s&&function(e){i.d(t,e,(function(){return o[e]}))}(s);i(243);var a,c=i(25),r=Object(c["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],a);r.options.__file="package-publishOrder/pages/newOrder.vue",t["default"]=r.exports},239:function(e,t,i){"use strict";i.r(t);var n=i(240);i.d(t,"render",(function(){return n["render"]})),i.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),i.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),i.d(t,"components",(function(){return n["components"]}))},240:function(e,t,i){"use strict";var n;i.r(t),i.d(t,"render",(function(){return o})),i.d(t,"staticRenderFns",(function(){return a})),i.d(t,"recyclableRender",(function(){return s})),i.d(t,"components",(function(){return n}));var o=function(){var e=this,t=e.$createElement;e._self._c},s=!1,a=[];o._withStripped=!0},241:function(e,t,i){"use strict";i.r(t);var n=i(242),o=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},242:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(i(26));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){i.e("package-publishOrder/components/addorder/order-time").then(function(){return resolve(i(591))}.bind(null,i)).catch(i.oe)},a=function(){i.e("package-publishOrder/components/addorder/order-wupin").then(function(){return resolve(i(598))}.bind(null,i)).catch(i.oe)},c=function(){Promise.all([i.e("common/vendor"),i.e("components/addorder/order-tip")]).then(function(){return resolve(i(605))}.bind(null,i)).catch(i.oe)},r=function(){i.e("package-publishOrder/components/addorder/order-priceDatl").then(function(){return resolve(i(612))}.bind(null,i)).catch(i.oe)},l=function(){Promise.all([i.e("common/vendor"),i.e("components/payview/payview")]).then(function(){return resolve(i(619))}.bind(null,i)).catch(i.oe)},d=i(42),u=new d.AMapWX({key:getApp().globalData.amapKey}),h={components:{timev:s,wupinMsgV:a,tipMoneyV:c,priceDatl:r,payView:l},data:function(){return{scrollHeight:0,bottomViewHeight:76,navHeight:0,name:"",phone:"",address:"",menpaihao:"",goods:"",beizhu:"",time:"",hasPrice:!1,allmoney:0,start_address:"",start_lat:0,start_lng:0,isShowTime:0,pickName:"",pickPhone:"",timeValue:{time:"请选择",servetime:0,tian:""},isShowWPMsg:0,wyMsg:{},isShowTip:0,tipMoney:"",price:0,distance:"",weight:"",distanceTime:0,timemoney:0,priceDic:{money_basic:0,money_distance:0,money_weight:0,money_time:0},showpay:0,isShowPrceDatl:0}},computed:{i18n:function(){return this.$t("index")}},onReady:function(){var t=e.getSystemInfoSync();this.navHeight=64+t.statusBarHeight,this.bottomViewHeight=60,this.scrollHeight=t.windowHeight-this.bottomViewHeight-this.navHeight},onLoad:function(){var t=this,i=e.getSystemInfoSync(),n=this;n.windowHeight=i.windowHeight,n.windowWidth=i.windowWidth;var o=e.getStorageSync("shopAddress");if(console.log(o),o&&o.address){var s=e.getStorageSync("userinfo");n.pickName=s.user_nickname,n.pickPhone=s.mobile,n.start_lat=o.lat,n.start_lng=o.lng,n.start_address=o.address,e.$on("beizhuChange",(function(e){n.beizhu=e})),e.$on("selectedAdsSuccess2",(function(e){console.log(e);var i=t;i.address=e.name,i.latitude=e.lat,i.longitude=e.lng,t.getRidingRouteDistance()})),e.$on("selectedAdsSuccess",(function(e){console.log(e)}))}else{n=this;e.showModal({title:"",content:n.i18n.postorder.noaddresstip,success:function(t){t.confirm?e.navigateTo({url:"../../package-mine/pages/editProfile/editProfile"}):t.cancel&&e.navigateBack()}})}},methods:{back:function(){e.navigateBack()},priceDatlHide:function(){this.isShowPrceDatl=!1},input1:function(e){this.name=e.detail.value},inputphone:function(e){this.phone=e.detail.value},choseAddress:function(){e.navigateTo({url:"../../package-mine/pages/address/handSelecedAds?from=2"})},inputmenpaihao:function(e){this.menpaihao=e.detail.value},chosegoodsinfo:function(){this.isShowWPMsg=1},choseBeizhu:function(){e.navigateTo({url:"./beizhu?beizhu="+this.beizhu})},choseTime:function(){this.isShowTime=!0},choseFee:function(){this.isShowTip=!0},xiadan:function(){this.showpay=1},showPriceDetail:function(){this.isShowPrceDatl=1},helpsendCheckTime:function(){var e=this;this.http.sendAppRequest("Helpsend.CheckTime",{servicetime:e.timeValue.servetime,cityid:"1"}).then((function(t){if(0==t.code){var i=e.timeValue.tian;i==e.i18n.postorder.tommow?e.time=e.timeValue.tian+e.timeValue.time:e.time=e.timeValue.time,e.timemoney=t.info[0].timemoney,e.priceDic.money_time=e.timemoney,e.computedTimeFee()}}))},computedTimeFee:function(){var e=parseFloat(this.priceDic.money_time);if(e>0){var t=e+parseFloat(this.allmoney);this.allmoney=String(t)}},wupinMsgSelcted:function(e){if(this.isShowWPMsg=!1,console.log(e),0!=e){this.wyMsg=e;var t=e.type;this.goods=t.name+" "+this.wyMsg.weight+"Kg",this.weight=this.wyMsg.weight,this.helpsendComputed()}},helpsendComputed:function(){var e={type:"2",start_lng:this.start_lng,start_lat:this.start_lat,end_lng:this.longitude,end_lat:this.latitude,distance:this.distance,weight:this.weight},t=this;t.http.sendAppRequest("Helpsend.Computed",e).then((function(e){if(0==e.code){var i=e.info[0];console.log(i),t.hasPrice=!0;var n=parseFloat(i.money_basic)+parseFloat(i.money_weight)+parseFloat(i.money_distance);t.allmoney=String(n),t.priceDic.money_basic=i.money_basic,t.priceDic.money_basic_txt=i.money_basic_txt,t.priceDic.money_weight=i.money_weight,t.priceDic.money_weight_txt=i.money_weight_txt,t.priceDic.money_distance=i.money_distance,t.priceDic.money_distance_txt=i.money_distance_txt}}))},timeSelcted:function(e){var t=this;t.isShowTime=0,0!=e&&(t.timeValue=e,t.helpsendCheckTime())},tipMoneyAdd:function(e){var t=this;if(t.isShowTip=0,0==e){if(t.tipMoney="",t.priceDic.money_small>0){var i=parseFloat(this.priceDic.money_small),n=parseFloat(this.allmoney)-i;this.allmoney=String(n)}t.priceDic.money_small=0}else{t.tipMoney=e,t.priceDic.money_small=t.tipMoney;i=parseFloat(this.priceDic.money_small);this.hasPrice=!0;n=parseFloat(this.allmoney)+i;this.allmoney=String(n)}},getRidingRouteDistance:function(){var e=this;setTimeout((function(){u.getRidingRoute({origin:e.start_lng+","+e.start_lat,destination:e.longitude+","+e.latitude,success:function(t){var i=[];if(t.paths&&t.paths[0]&&t.paths[0].rides)for(var n=t.paths[0].rides,o=0;o<n.length;o++)for(var s=n[o].polyline.split(";"),a=0;a<s.length;a++)i.push({longitude:parseFloat(s[a].split(",")[0]),latitude:parseFloat(s[a].split(",")[1])});e.polyline=[{points:i,color:"#00c1de",width:6}],e.distance=t.paths[0].distance,e.helpsendGetLengthWithDistance()},fail:function(e){}})}),500)},helpsendGetLengthWithDistance:function(){var e=this;n.default.sendAppRequest("Helpsend.GetLength",{distance:e.distance}).then((function(t){0==t.code&&(e.distanceTime=t.info[0].length)}))},closePayView:function(t){if(console.log(t),this.showpay=0,0==t);else{var i={type:"2",start_name:this.start_address,start_lng:this.start_lng,start_lat:this.start_lat,pick_name:this.pickName,pick_phone:this.pickPhone,end_name:this.address,end_addr:this.menpaihao,end_lng:this.longitude,end_lat:this.latitude,recip_name:this.name,recip_phone:this.phone,distance:this.distance,weight:this.weight,servicetime:this.timeValue.servetime,cateid:this.wyMsg.type.id,des:this.beizhu,fee:this.tipMoney,is_mer:"1"};console.log(i),i.openid=e.getStorageSync("openid"),i.payid=2==t.id?"3":t.id;var n=this;n.http.sendAppRequest("Helpsend.Create",i).then((function(i){console.log(i),0==i.code?0==t.id?(e.showToast({title:"支付成功",duration:2e3}),n.back()):1==t.id?e.requestPayment({provider:"alipay",orderInfo:i.info[0].ali.orderinfo,success:function(t){e.showToast({title:"支付成功",duration:2e3}),console.log("success:"+JSON.stringify(t)),n.back()},fail:function(e){console.log("fail:"+JSON.stringify(e)),n.back()}}):2==t.id&&e.requestPayment({provider:"wxpay",timeStamp:i.info[0].small.timeStamp,nonceStr:i.info[0].small.nonceStr,package:i.info[0].small.package,signType:i.info[0].small.signType,paySign:i.info[0].small.sign,success:function(t){e.showToast({title:"支付成功",duration:2e3}),console.log(t),n.back()},fail:function(e){console.log(e),n.back()}}):981==i.code&&0==t.id&&n.back()}))}}}};t.default=h}).call(this,i(1)["default"])},243:function(e,t,i){"use strict";i.r(t);var n=i(244),o=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},244:function(e,t,i){}},[[237,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/package-publishOrder/pages/newOrder.js.map